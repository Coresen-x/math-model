# 割平面法

## 一、基本思想  
割平面法用于求解**整数线性规划（ILP）**问题，核心逻辑基于**线性规划（LP）松弛问题**逐步切割可行域：  

设原整数规划问题为 \((P)\)，其线性松弛问题为 \((P_0)\)，则：  
1. 若 \((P_0)\) 无解 → \((P)\) 无解  
2. 若 \((P_0)\) 最优解是整数向量 → 该解也是 \((P)\) 的最优解  
3. 若 \((P_0)\) 解含非整数分量 → 构造**割平面约束**（线性不等式），切割 \((P_0)\) 的可行域（割去含当前非整数解的区域，但保留 \((P)\) 的所有可行解），得到新问题 \((P_1)\)，重复上述过程  


## 二、算法步骤（数学推导）  

### 1. 线性松弛与初始解  
设 \((P_0)\) 的最优解为 \( \boldsymbol{x}^* \)，若存在非整数分量 \( x_j^* \notin \mathbb{Z} \)，取对应**标准形约束方程**（基变量为 \( x_j \)）：  
$$ x_j + \sum_{k \in N} a_{jk} x_k = b_j $$  

符号说明：  
- \( N \)：非基变量索引集合  
- \( a_{jk} \)：约束系数  
- \( b_j \)：约束常数项  


### 2. 系数拆分（整数 + 小数部分）  
将系数 \( a_{jk} \) 和常数项 \( b_j \) 拆分为**整数部分**（下取整 \( \lfloor \cdot \rfloor \)）和**小数部分**（记 \( f_{jk}, f_j \)，满足 \( 0 \leq f_{jk}, f_j < 1 \)）：  
$$ 
\begin{cases} 
a_{jk} = \lfloor a_{jk} \rfloor + f_{jk} \\ 
b_j = \lfloor b_j \rfloor + f_j 
\end{cases} 
$$  


### 3. 构造割平面约束  
将拆分结果代入原约束方程：  
$$ x_j + \sum_{k \in N} \lfloor a_{jk} \rfloor x_k + \sum_{k \in N} f_{jk} x_k = \lfloor b_j \rfloor + f_j $$  

**整数项与小数项分离**（移项整理）：  
$$ x_j + \sum_{k \in N} \lfloor a_{jk} \rfloor x_k - \lfloor b_j \rfloor = f_j - \sum_{k \in N} f_{jk} x_k $$  

由于左侧是**整数**（基/非基变量与整数系数运算结果），右侧需满足整数性。结合：  
- \( x_k \geq 0 \)（非负约束）  
- \( 0 \leq f_{jk}, f_j < 1 \)（小数部分定义）  

推导得**割平面约束**：  
$$ \sum_{k \in N} f_{jk} x_k \geq f_j $$  


### 4. 迭代切割与求解  
将新割平面约束加入 \((P_0)\)，得到新问题 \((P_1)\)。由于割平面会使原最优解不可行（但保留所有整数可行解），用**对偶单纯形法**求解（适合处理“可行解不可行，检验数仍最优”的场景）。  

重复流程：  
`检查整数解 → 构造割平面 → 对偶单纯形法求解`  
直到得到全整数解。  


## 三、算法流程图（Mermaid 语法）  
```mermaid
flowchart TD
    A[开始] --> B[初始化: 定义(P)和(P₀)]
    B --> C{求解(P₀)是否有解?}
    C -->|无解| D[输出: (P)无解]
    C -->|有解| E[检查(P₀)最优解是否全整数?]
    E -->|是| F[输出: 该解为(P)最优解]
    E -->|否| G[构造割平面约束]
    G --> H[将约束加入(P₀)得到(P₁)]
    H --> I[用对偶单纯形法解(P₁)]
    I --> E
    D --> J[结束]
    F --> J
